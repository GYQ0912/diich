<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>代表性传承人</title>
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/logo.png" media="screen" />
    <link rel="stylesheet" href="/assets/css/common.css">
    <link rel="stylesheet" href="/assets/css/layout.css">
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/data/master_data.js"></script>
    <script src="/assets/js/system.js"></script>
    <script src="http://diich.efeiyi.com/js/category.js"></script>
    <script src="http://diich.efeiyi.com/js/citys.js"></script>
    <script src="/js/masters.js"></script>
    <script type="text/javascript" src="/js/jquery.i18n.properties-1.0.9.js"></script>
    <script src="../js/i18n.js"></script>
</head>

<body>
    <div class="header header_detail"></div>
    <!--//End header -->

    <div class="filter_search filter_search_fixed">
        <div class="content">
            <form class="form" action="http://diich.efeiyi.com/page/search.html">
                <input class="ipt" type="text" id="keyword" name="keyword" value="" autocomplete="off">
                <input type="hidden" id="area_code" name="area_code" value="" />
                <input type="hidden" id="gb_category_code" name="gb_category_code" value="" />
                <input type="hidden" id="type" name="type" value="" />
                <input class="submit" type="button" value="搜索" onclick="submit()">
                <div class="suggest" style="display: none;">
                    <ul>

                    </ul>
                </div>
            </form>
            <!--//End form-->

            <div class="attr">
                <span id="attr_text">所属类别</span>
                <span id="area_text">全球</span>
            </div>
            <!--//End attribute-->

            <div class="dropbox" id="drag">
                <!--//ENd 全部-->

                <div class="item" id="item_1">
                    <dl class="level">
                        <dt>
                        <div class="title">一级分类</div>
                        <div class="subtitle">所有分类</div>
                        </dt>
                        <dd>
                            <ul id="mainCategory">

                            </ul>
                        </dd>
                    </dl>
                    <dl class="level2">
                        <dt>
                        <div class="title">二级分类</div>
                        <div class="subtitle">所有二级分类</div>
                        </dt>
                        <dd>
                            <ul id="catecontent">

                            </ul>
                        </dd>
                    </dl>
                </div>
                <!--//End 所属分类-->

                <div class="item">
                    <dl class="level">
                        <dt>
                        <div class="title">位置</div>
                        </dt>
                        <dd>
                            <ul>
                                <li>中国</li>
                            </ul>
                        </dd>
                    </dl>
                    <dl class="level2">
                        <dt>
                        <div class="title">按照字母顺序</div>
                        </dt>
                        <dd>
                            <ul id="citycontent">
                                <li>安微</li>
                                <li>澳门</li>
                                <li>北京</li>
                                <li>上海</li>
                                <li>福建</li>
                                <li>甘肃</li>
                                <li>广东</li>
                            </ul>
                        </dd>
                    </dl>
                </div>
                <!--//End 位置-->

            </div>
            <!--//End attribute-->
        </div>
    </div>
    <!--//End filter_search -->


    <div class="master_page">
        <div class="lbox">
            <ul class="master_avatar">
                <!--<li>
                    <img src="/assets/uploads/master1.jpg" alt="">
                    <div class="mask">
                        <h4>张同禄1</h4>
                        <p>中国国家级非遗传承人</p>
                    </div>
                </li>-->
            </ul>
        </div>
        <div class="rbox">
            <div class="default">
                <div class="title">
                    <h1>非遗大师<br>人类群星闪耀时</h1>
                    <!--<h4>Masters who have made tremendous contribution to our culture.</h4>-->
                </div>
                <div class="context">
                    <p>当文化隐在历史里，有人说，过去的，就会成为过去。可当暗夜里月光黯淡，星光退却，总会有人成为日夜兼程的火种，用时间，挥散黑夜。星星之火，相传成光。</p>
                </div>
                <div class="bottom">
                    <a href="" class="more"><i></i>点击大师头像查看更多</a>
                </div>
            </div>
            <!--//End 默认部分-->

            <div class="item" style="">
                <div class="title">
                    <h1><!--张同禄--></h1>
                    <div class="cate"><!--景泰蓝制作技艺--></div>
                    <h4><!--中国国家级非遗传承人 北京市高级工艺美术大师--></h4>
                    <!--<div class="doi">
                        <span class="tag">DO</span>
                        <span class="zh">标识码</span>
                        <span class="num">37232519870103004383</span>
                    </div>-->
                </div>
                <!--//End title-->
                <div class="context">
                    <p></p>
                </div>
                <!--//End context-->
                <div class="bottom">
                    <a class="arrow_right" href="javascript:0;">MORE</a>
                    <div class="imgs">
                        <a href="javascript:0;"><img src="" alt=""></a>
                        <a href="javascript:0;"><img src="" alt=""></a>
                        <a href="javascript:0;"><img src="" alt=""></a>
                    </div>
                </div>

            </div>
            <!--//End-->

        </div>
    </div>
    <!-- 非遗大师 主内容 end -->

    <div class="bd footer"></div>
    <!--//End--footer-->

</body>
<script>
    $(function() {
        $('.header .content .nav li').eq(2).addClass('active').siblings('li').removeClass('active');
        var mainCategory = $('#mainCategory');

        //初始化分类数据
        $.each(category_all, function(index, content) {
            mainCategory.append("<li data-id=\"" + content.gbCategory + "\" >" + content.name + "</li>");
        });

        mainCategory.find('li').on('click', function() {
            $("#attr_text").text($(this).html());
            $("#gb_category_code").val($(this).attr("data-id"));
            $("#item_1").hide();

            //searchData_();
        });

        var searchPage = {
            init: function() {
                //$('.header_detail .content .info li.search').hide();
                $('.header_detail .content .info li.login').addClass('line');
                this.filterBar();
                this.search();
            },
            filterBar: function() {
                var obj = $('.filter_bar');
                var linkTab = obj.find('a');
                var iconTab = obj.find('.icon_tab');
                var proColumn = $('.pro_column3'); //搜索列表

                //筛选
                linkTab.on('click', function() {
                    $(this).addClass('active').siblings('a').removeClass('active');

                    //刷新搜索结果页

                    if ($(this).index() == 0) {
                        $("#type").val("");
                    }
                    if ($(this).index() == 1) {
                        $("#type").val("0");
                    }
                    if ($(this).index() == 2) {
                        $("#type").val("1");
                    }
                    if ($(this).index() == 3) {
                        $("#type").val("2");
                    }

                    searchData_();

                    return false;
                });

                //切换图标
                iconTab.on('click', function() {
                    if ($(this).hasClass('active')) { //九宫格
                        $(this).removeClass('active');
                        proColumn.removeClass('active');
                    } else { //横排
                        $(this).addClass('active');
                        proColumn.addClass('active');
                    }
                });
            },
            search: function() {
                var filter = $('.filter_search'); //下拉搜索
                var filterFixed = $('.filter_search_fixed');
                var ipt = filter.find('.ipt');
                var iptVal = ipt.val();
                var filterAll = filter.find('.attr span'); //筛选项
                var filterItem = filter.find('.item'); //筛选下来框
                var suggest = filter.find('.suggest');
                var body = $('body');
                //获取焦点
                ipt.focus(function() {
                    $(this).val('');
                    body.append('<div class="overbg" style="z-index:1;"></div>');
                });

                //失去焦点如果为空则显示原始值
                ipt.blur(function() {
                    var _val = $(this).val();
                    if (_val == '') {
                        $(this).val(iptVal);
                    }
                    $('.overbg').remove();
                });

                //2.点击筛选
                filterAll.on('click', function() {
                    var _this = $(this);
                    var _index = _this.index();
                    filterItem.eq(_index)
                            .css('left', parseInt(_this.position().left) + 'px')
                            .show()
                            .siblings('.item')
                            .hide();
                });

                filterItem.each(function() {
                    var _this = $(this);
                    var level = $(this).find('.level');
                    var level2 = $(this).find('.level2');
                    var _li = level.find('li'); //分类

                    _li.hover(function() {
                        $(this).addClass('active').siblings('li').removeClass('active');

                        $("#catecontent").empty();
                        $("#citycontent").empty();

                        if (typeof(category_all[$(this).index()].children) != "undefined") {
                            $.each(category_all[$(this).index()].children, function(index, content) {
                                $("#catecontent").append("<li data-id=\"" + content.gbCategory + "\" >" + content.name + "</li>");
                            });

                            //点击二级分类
                            $("#catecontent").find('li').on('click', function() {
                                filterAll.eq(0).text($(this).html());
                                _this.hide();
                                $("#gb_category_code").val($(this).attr("data-id"));
                                //searchData_();
                            });
                        }

                        if (typeof(dic_arr_city) != "undefined") {
                            $.each(dic_arr_city, function(index, content) {
                                $("#citycontent").append("<li data-id=\"" + content.code + "\"  >" + content.name + "</li>");
                            });

                            //国家级
                            $("#country").find('li').on('click', function() {
                                filterAll.eq(1).text($(this).html());
                                _this.hide();
                                $("#area_code").val("");
                                // searchData_();
                            });

                            //一级城市
                            $("#citycontent").find('li').on('click', function() {
                                filterAll.eq(1).text($(this).html());
                                _this.hide();
                                $("#area_code").val($(this).attr("data-id"));
                                //searchData_();
                            });
                        }
                        level2.show();
                    });
                });


                //点击一级类别

                //3.阻止点击自身关闭
                filter.on('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                });

                //4.点击自身之外的地方关闭下拉框
                $(document).on("click", function() {
                    filterItem.hide();
                    filterFixed.slideUp('fast');
                });
                //自动提示
                body.find('.overbg').on('click', function() {
                    filterItem.hide();
                    filterFixed.slideUp('fast');
                    suggest.hide();
                    $(this).remove();
                    body.css('overflow', '');
                });

            },
        };
        searchPage.init();
    })
</script>

</html>